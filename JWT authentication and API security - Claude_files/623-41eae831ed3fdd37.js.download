"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[623],{24759:(e,t,r)=>{let a;r.d(t,{_:()=>A});var s,i=r(97329),n=r(23670),o=r(4933);class l extends i.Zs{constructor(e,t){var r;super(t),this._serverInfo=e,this._capabilities=null!=(r=null==t?void 0:t.capabilities)?r:{},this._instructions=null==t?void 0:t.instructions,this.setRequestHandler(n.rk,e=>this._oninitialize(e)),this.setNotificationHandler(n.ZC,()=>{var e;return null==(e=this.oninitialized)?void 0:e.call(this)})}registerCapabilities(e){if(this.transport)throw Error("Cannot register capabilities after connecting to transport");this._capabilities=(0,i.hG)(this._capabilities,e)}assertCapabilityForMethod(e){var t,r,a;switch(e){case"sampling/createMessage":if(!(null==(t=this._clientCapabilities)?void 0:t.sampling))throw Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(null==(r=this._clientCapabilities)?void 0:r.elicitation))throw Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(null==(a=this._clientCapabilities)?void 0:a.roots))throw Error(`Client does not support listing roots (required for ${e})`)}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw Error(`Server does not support notifying of prompt list changes (required for ${e})`)}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw Error(`Server does not support tools (required for ${e})`)}}async _oninitialize(e){let t=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:n.Iu.includes(t)?t:n.aE,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},n.wR)}async createMessage(e,t){return this.request({method:"sampling/createMessage",params:e},n.K1,t)}async elicitInput(e,t){let r=await this.request({method:"elicitation/create",params:e},n.n_,t);if("accept"===r.action&&r.content)try{let t=new o,a=t.compile(e.requestedSchema);if(!a(r.content))throw new n.Nh(n.O4.InvalidParams,`Elicitation response content does not match requested schema: ${t.errorsText(a.errors)}`)}catch(e){if(e instanceof n.Nh)throw e;throw new n.Nh(n.O4.InternalError,`Error validating elicitation response: ${e}`)}return r}async listRoots(e,t){return this.request({method:"roots/list",params:e},n.Cs,t)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}let c=Symbol("Let zodToJsonSchema decide on which parser to use"),u={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};var d=r(24407);function m(e,t,r,a){a?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function p(e,t,r,a,s){e[t]=r,m(e,t,a,s)}function h(e,t){return S(e.type._def,t)}let f={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===a&&(a=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),a),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function g(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":p(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t);break;case"max":p(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":b(r,"email",a.message,t);break;case"format:idn-email":b(r,"idn-email",a.message,t);break;case"pattern:zod":_(r,f.email,a.message,t)}break;case"url":b(r,"uri",a.message,t);break;case"uuid":b(r,"uuid",a.message,t);break;case"regex":_(r,a.regex,a.message,t);break;case"cuid":_(r,f.cuid,a.message,t);break;case"cuid2":_(r,f.cuid2,a.message,t);break;case"startsWith":_(r,RegExp(`^${v(a.value,t)}`),a.message,t);break;case"endsWith":_(r,RegExp(`${v(a.value,t)}$`),a.message,t);break;case"datetime":b(r,"date-time",a.message,t);break;case"date":b(r,"date",a.message,t);break;case"time":b(r,"time",a.message,t);break;case"duration":b(r,"duration",a.message,t);break;case"length":p(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t),p(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"includes":_(r,RegExp(v(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&b(r,"ipv4",a.message,t),"v4"!==a.version&&b(r,"ipv6",a.message,t);break;case"base64url":_(r,f.base64url,a.message,t);break;case"jwt":_(r,f.jwt,a.message,t);break;case"cidr":"v6"!==a.version&&_(r,f.ipv4Cidr,a.message,t),"v4"!==a.version&&_(r,f.ipv6Cidr,a.message,t);break;case"emoji":_(r,f.emoji(),a.message,t);break;case"ulid":_(r,f.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":b(r,"binary",a.message,t);break;case"contentEncoding:base64":p(r,"contentEncoding","base64",a.message,t);break;case"pattern:zod":_(r,f.base64,a.message,t)}break;case"nanoid":_(r,f.nanoid,a.message,t)}return r}function v(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)y.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}let y=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function b(e,t,r,a){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&a.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):p(e,"format",t,r,a)}function _(e,t,r,a){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&a.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:k(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):p(e,"pattern",k(t,a),r,a)}function k(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},a=r.i?e.source.toLowerCase():e.source,s="",i=!1,n=!1,o=!1;for(let e=0;e<a.length;e++){if(i){s+=a[e],i=!1;continue}if(r.i){if(n){if(a[e].match(/[a-z]/)){o?(s+=a[e],s+=`${a[e-2]}-${a[e]}`.toUpperCase(),o=!1):"-"===a[e+1]&&a[e+2]?.match(/[a-z]/)?(s+=a[e],o=!0):s+=`${a[e]}${a[e].toUpperCase()}`;continue}}else if(a[e].match(/[a-z]/)){s+=`[${a[e]}${a[e].toUpperCase()}]`;continue}}if(r.m){if("^"===a[e]){s+=`(^|(?<=[\r
]))`;continue}else if("$"===a[e]){s+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===a[e]){s+=n?`${a[e]}\r
`:`[${a[e]}\r
]`;continue}s+=a[e],"\\"===a[e]?i=!0:n&&"]"===a[e]?n=!1:n||"["!==a[e]||(n=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function P(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===d.kY.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,a)=>({...r,[a]:S(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",a]})??{}}),{}),additionalProperties:!1};let r={type:"object",additionalProperties:S(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===d.kY.ZodString&&e.keyType._def.checks?.length){let{type:a,...s}=g(e.keyType._def,t);return{...r,propertyNames:s}}if(e.keyType?._def.typeName===d.kY.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===d.kY.ZodBranded&&e.keyType._def.type._def.typeName===d.kY.ZodString&&e.keyType._def.type._def.checks?.length){let{type:a,...s}=h(e.keyType._def,t);return{...r,propertyNames:s}}return r}let w={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},R=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>S(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0};function S(e,t,r=!1){let a=t.seen.get(e);if(t.override){let s=t.override?.(e,t,a,r);if(s!==c)return s}if(a&&!r){let e=T(a,t);if(void 0!==e)return e}let s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);let i=$(e,e.typeName,t);return i&&Z(e,t,i),s.jsonSchema=i,i}let T=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:C(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},C=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},$=(e,t,r)=>{switch(t){case d.kY.ZodString:return g(e,r);case d.kY.ZodNumber:return function(e,t){let r={type:"number"};if(!e.checks)return r;for(let a of e.checks)switch(a.kind){case"int":r.type="integer",m(r,"type",a.message,t);break;case"min":"jsonSchema7"===t.target?a.inclusive?p(r,"minimum",a.value,a.message,t):p(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),p(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?p(r,"maximum",a.value,a.message,t):p(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),p(r,"maximum",a.value,a.message,t));break;case"multipleOf":p(r,"multipleOf",a.value,a.message,t)}return r}(e,r);case d.kY.ZodObject:return function(e,t){let r="openAi"===t.target,a={type:"object",...Object.entries(e.shape()).reduce((e,[a,s])=>{if(void 0===s||void 0===s._def)return e;let i=s.isOptional();i&&r&&(s instanceof d.Ii&&(s=s._def.innerType),s.isNullable()||(s=s.nullable()),i=!1);let n=S(s._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return void 0===n?e:{properties:{...e.properties,[a]:n},required:i?e.required:[...e.required,a]}},{properties:{},required:[]}),additionalProperties:"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:S(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:S(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return a.required.length||delete a.required,a}(e,r);case d.kY.ZodBigInt:return function(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let a of e.checks)switch(a.kind){case"min":"jsonSchema7"===t.target?a.inclusive?p(r,"minimum",a.value,a.message,t):p(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),p(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?p(r,"maximum",a.value,a.message,t):p(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),p(r,"maximum",a.value,a.message,t));break;case"multipleOf":p(r,"multipleOf",a.value,a.message,t)}return r}(e,r);case d.kY.ZodBoolean:return{type:"boolean"};case d.kY.ZodDate:return function e(t,r,a){let s=a??r.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((a,s)=>e(t,r,a))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var i=t,n=r;let o={type:"integer",format:"unix-time"};if("openApi3"===n.target)return o;for(let e of i.checks)switch(e.kind){case"min":p(o,"minimum",e.value,e.message,n);break;case"max":p(o,"maximum",e.value,e.message,n)}return o}}(e,r);case d.kY.ZodUndefined:return{not:{}};case d.kY.ZodNull:return"openApi3"===r.target?{enum:["null"],nullable:!0}:{type:"null"};case d.kY.ZodArray:return function(e,t){let r={type:"array"};return e.type?._def&&e.type?._def?.typeName!==d.kY.ZodAny&&(r.items=S(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&p(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&p(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(p(r,"minItems",e.exactLength.value,e.exactLength.message,t),p(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}(e,r);case d.kY.ZodUnion:case d.kY.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return R(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in w&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=w[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return R(e,t)}(e,r);case d.kY.ZodIntersection:return function(e,t){let r=[S(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),S(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),a="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,s=[];return r.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)s.push(...e.allOf),void 0===e.unevaluatedProperties&&(a=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}else a=void 0;s.push(t)}}),s.length?{allOf:s,...a}:void 0}(e,r);case d.kY.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>S(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:S(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>S(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case d.kY.ZodRecord:return P(e,r);case d.kY.ZodLiteral:return function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}(e,r);case d.kY.ZodEnum:return{type:"string",enum:Array.from(e.values)};case d.kY.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),a=Array.from(new Set(r.map(e=>typeof e)));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case d.kY.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:w[e.innerType._def.typeName],nullable:!0}:{type:[w[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let r=S(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}let r=S(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case d.kY.ZodOptional:return((e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return S(e.innerType._def,t);let r=S(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}})(e,r);case d.kY.ZodMap:return function(e,t){return"record"===t.mapStrategy?P(e,t):{type:"array",maxItems:125,items:{type:"array",items:[S(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},S(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case d.kY.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:S(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&p(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&p(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}(e,r);case d.kY.ZodLazy:return S(e.getter()._def,r);case d.kY.ZodPromise:return S(e.type._def,r);case d.kY.ZodNaN:case d.kY.ZodNever:return{not:{}};case d.kY.ZodEffects:return function(e,t){return"input"===t.effectStrategy?S(e.schema._def,t):{}}(e,r);case d.kY.ZodAny:case d.kY.ZodUnknown:return{};case d.kY.ZodDefault:return function(e,t){return{...S(e.innerType._def,t),default:e.defaultValue()}}(e,r);case d.kY.ZodBranded:return h(e,r);case d.kY.ZodReadonly:case d.kY.ZodCatch:return S(e.innerType._def,r);case d.kY.ZodPipeline:return((e,t)=>{if("input"===t.pipeStrategy)return S(e.in._def,t);if("output"===t.pipeStrategy)return S(e.out._def,t);let r=S(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),a=S(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(e=>void 0!==e)}})(e,r);case d.kY.ZodFunction:case d.kY.ZodVoid:case d.kY.ZodSymbol:default:return}},Z=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r),O=(e,t)=>{let r=(e=>{let t=(e=>"string"==typeof e?{...u,name:e}:{...u,...e})(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}})(t),a="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,a])=>({...e,[t]:S(a._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??{}}),{}):void 0,s="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,i=S(e._def,void 0===s?r:{...r,currentPath:[...r.basePath,r.definitionPath,s]},!1)??{},n="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==n&&(i.title=n);let o=void 0===s?a?{...i,[r.definitionPath]:a}:i:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:{...a,[s]:i}};return"jsonSchema7"===r.target?o.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===r.target||"openAi"===r.target)&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===r.target&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};(s||(s={})).Completable="McpCompletable";class x extends d.aR{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}x.create=(e,t)=>new x({type:e,typeName:s.Completable,complete:t.complete,...function(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:s}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:s}:{errorMap:(t,s)=>{var i,n;let{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!=(i=null!=o?o:a)?i:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!=(n=null!=o?o:r)?n:s.defaultError}},description:s}}(t)});class A{constructor(e,t){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new l(e,t)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(n.gW.shape.method.value),this.server.assertCanSetRequestHandler(n.FT.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(n.gW,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,t])=>{let r={name:e,title:t.title,description:t.description,inputSchema:t.inputSchema?O(t.inputSchema,{strictUnions:!0}):I,annotations:t.annotations};return t.outputSchema&&(r.outputSchema=O(t.outputSchema,{strictUnions:!0})),r})})),this.server.setRequestHandler(n.FT,async(e,t)=>{let r,a=this._registeredTools[e.params.name];if(!a)throw new n.Nh(n.O4.InvalidParams,`Tool ${e.params.name} not found`);if(!a.enabled)throw new n.Nh(n.O4.InvalidParams,`Tool ${e.params.name} disabled`);if(a.inputSchema){let s=await a.inputSchema.safeParseAsync(e.params.arguments);if(!s.success)throw new n.Nh(n.O4.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${s.error.message}`);let i=s.data,o=a.callback;try{r=await Promise.resolve(o(i,t))}catch(e){r={content:[{type:"text",text:e instanceof Error?e.message:String(e)}],isError:!0}}}else{let e=a.callback;try{r=await Promise.resolve(e(t))}catch(e){r={content:[{type:"text",text:e instanceof Error?e.message:String(e)}],isError:!0}}}if(a.outputSchema&&!r.isError){if(!r.structuredContent)throw new n.Nh(n.O4.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);let t=await a.outputSchema.safeParseAsync(r.structuredContent);if(!t.success)throw new n.Nh(n.O4.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${t.error.message}`)}return r}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(n.iK.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(n.iK,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new n.Nh(n.O4.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,t){let r=this._registeredPrompts[t.name];if(!r)throw new n.Nh(n.O4.InvalidParams,`Prompt ${t.name} not found`);if(!r.enabled)throw new n.Nh(n.O4.InvalidParams,`Prompt ${t.name} disabled`);if(!r.argsSchema)return E;let a=r.argsSchema.shape[e.params.argument.name];if(!(a instanceof x))return E;let s=a._def;return N(await s.complete(e.params.argument.value,e.params.context))}async handleResourceCompletion(e,t){let r=Object.values(this._registeredResourceTemplates).find(e=>e.resourceTemplate.uriTemplate.toString()===t.uri);if(!r){if(this._registeredResources[t.uri])return E;throw new n.Nh(n.O4.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let a=r.resourceTemplate.completeCallback(e.params.argument.name);return a?N(await a(e.params.argument.value,e.params.context)):E}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(n.OI.shape.method.value),this.server.assertCanSetRequestHandler(n.s.shape.method.value),this.server.assertCanSetRequestHandler(n.R6.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(n.OI,async(e,t)=>{let r=Object.entries(this._registeredResources).filter(([e,t])=>t.enabled).map(([e,t])=>({uri:e,name:t.name,...t.metadata})),a=[];for(let e of Object.values(this._registeredResourceTemplates))if(e.resourceTemplate.listCallback)for(let r of(await e.resourceTemplate.listCallback(t)).resources)a.push({...e.metadata,...r});return{resources:[...r,...a]}}),this.server.setRequestHandler(n.s,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([e,t])=>({name:e,uriTemplate:t.resourceTemplate.uriTemplate.toString(),...t.metadata}))})),this.server.setRequestHandler(n.R6,async(e,t)=>{let r=new URL(e.params.uri),a=this._registeredResources[r.toString()];if(a){if(!a.enabled)throw new n.Nh(n.O4.InvalidParams,`Resource ${r} disabled`);return a.readCallback(r,t)}for(let e of Object.values(this._registeredResourceTemplates)){let a=e.resourceTemplate.uriTemplate.match(r.toString());if(a)return e.readCallback(r,a,t)}throw new n.Nh(n.O4.InvalidParams,`Resource ${r} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(n.Qq.shape.method.value),this.server.assertCanSetRequestHandler(n.$p.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(n.Qq,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,t])=>({name:e,title:t.title,description:t.description,arguments:t.argsSchema?Object.entries(t.argsSchema.shape).map(([e,t])=>({name:e,description:t.description,required:!t.isOptional()})):void 0}))})),this.server.setRequestHandler(n.$p,async(e,t)=>{let r=this._registeredPrompts[e.params.name];if(!r)throw new n.Nh(n.O4.InvalidParams,`Prompt ${e.params.name} not found`);if(!r.enabled)throw new n.Nh(n.O4.InvalidParams,`Prompt ${e.params.name} disabled`);if(r.argsSchema){let a=await r.argsSchema.safeParseAsync(e.params.arguments);if(!a.success)throw new n.Nh(n.O4.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${a.error.message}`);let s=a.data,i=r.callback;return await Promise.resolve(i(s,t))}{let e=r.callback;return await Promise.resolve(e(t))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,t,...r){let a;"object"==typeof r[0]&&(a=r.shift());let s=r[0];if("string"==typeof t){if(this._registeredResources[t])throw Error(`Resource ${t} is already registered`);let r=this._createRegisteredResource(e,void 0,t,a,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),r}{if(this._registeredResourceTemplates[e])throw Error(`Resource template ${e} is already registered`);let r=this._createRegisteredResourceTemplate(e,void 0,t,a,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),r}}registerResource(e,t,r,a){if("string"==typeof t){if(this._registeredResources[t])throw Error(`Resource ${t} is already registered`);let s=this._createRegisteredResource(e,r.title,t,r,a);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}{if(this._registeredResourceTemplates[e])throw Error(`Resource template ${e} is already registered`);let s=this._createRegisteredResourceTemplate(e,r.title,t,r,a);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,t,r,a,s){let i={name:e,title:t,metadata:a,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:e=>{void 0!==e.uri&&e.uri!==r&&(delete this._registeredResources[r],e.uri&&(this._registeredResources[e.uri]=i)),void 0!==e.name&&(i.name=e.name),void 0!==e.title&&(i.title=e.title),void 0!==e.metadata&&(i.metadata=e.metadata),void 0!==e.callback&&(i.readCallback=e.callback),void 0!==e.enabled&&(i.enabled=e.enabled),this.sendResourceListChanged()}};return this._registeredResources[r]=i,i}_createRegisteredResourceTemplate(e,t,r,a,s){let i={resourceTemplate:r,title:t,metadata:a,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:t=>{void 0!==t.name&&t.name!==e&&(delete this._registeredResourceTemplates[e],t.name&&(this._registeredResourceTemplates[t.name]=i)),void 0!==t.title&&(i.title=t.title),void 0!==t.template&&(i.resourceTemplate=t.template),void 0!==t.metadata&&(i.metadata=t.metadata),void 0!==t.callback&&(i.readCallback=t.callback),void 0!==t.enabled&&(i.enabled=t.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=i,i}_createRegisteredPrompt(e,t,r,a,s){let i={title:t,description:r,argsSchema:void 0===a?void 0:d.z.object(a),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:t=>{void 0!==t.name&&t.name!==e&&(delete this._registeredPrompts[e],t.name&&(this._registeredPrompts[t.name]=i)),void 0!==t.title&&(i.title=t.title),void 0!==t.description&&(i.description=t.description),void 0!==t.argsSchema&&(i.argsSchema=d.z.object(t.argsSchema)),void 0!==t.callback&&(i.callback=t.callback),void 0!==t.enabled&&(i.enabled=t.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,i}_createRegisteredTool(e,t,r,a,s,i,n){let o={title:t,description:r,inputSchema:void 0===a?void 0:d.z.object(a),outputSchema:void 0===s?void 0:d.z.object(s),annotations:i,callback:n,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:t=>{void 0!==t.name&&t.name!==e&&(delete this._registeredTools[e],t.name&&(this._registeredTools[t.name]=o)),void 0!==t.title&&(o.title=t.title),void 0!==t.description&&(o.description=t.description),void 0!==t.paramsSchema&&(o.inputSchema=d.z.object(t.paramsSchema)),void 0!==t.callback&&(o.callback=t.callback),void 0!==t.annotations&&(o.annotations=t.annotations),void 0!==t.enabled&&(o.enabled=t.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=o,this.setToolRequestHandlers(),this.sendToolListChanged(),o}tool(e,...t){let r,a,s,i;if(this._registeredTools[e])throw Error(`Tool ${e} is already registered`);if("string"==typeof t[0]&&(r=t.shift()),t.length>1){let e=t[0];j(e)?(a=t.shift(),t.length>1&&"object"==typeof t[0]&&null!==t[0]&&!j(t[0])&&(i=t.shift())):"object"==typeof e&&null!==e&&(i=t.shift())}let n=t[0];return this._createRegisteredTool(e,void 0,r,a,s,i,n)}registerTool(e,t,r){if(this._registeredTools[e])throw Error(`Tool ${e} is already registered`);let{title:a,description:s,inputSchema:i,outputSchema:n,annotations:o}=t;return this._createRegisteredTool(e,a,s,i,n,o,r)}prompt(e,...t){let r,a;if(this._registeredPrompts[e])throw Error(`Prompt ${e} is already registered`);"string"==typeof t[0]&&(r=t.shift()),t.length>1&&(a=t.shift());let s=t[0],i=this._createRegisteredPrompt(e,void 0,r,a,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,t,r){if(this._registeredPrompts[e])throw Error(`Prompt ${e} is already registered`);let{title:a,description:s,argsSchema:i}=t,n=this._createRegisteredPrompt(e,a,s,i,r);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),n}isConnected(){return void 0!==this.server.transport}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}}let I={type:"object",properties:{}};function j(e){return"object"==typeof e&&null!==e&&(0===Object.keys(e).length||Object.values(e).some(q))}function q(e){return null!==e&&"object"==typeof e&&"parse"in e&&"function"==typeof e.parse&&"safeParse"in e&&"function"==typeof e.safeParse}function N(e){return{completion:{values:e.slice(0,100),total:e.length,hasMore:e.length>100}}}let E={completion:{values:[],hasMore:!1}}},86361:(e,t,r)=>{r.d(t,{W:()=>a});class a{constructor(){this._messageQueue=[]}static createLinkedPair(){let e=new a,t=new a;return e._otherTransport=t,t._otherTransport=e,[e,t]}async start(){for(var e;this._messageQueue.length>0;){let t=this._messageQueue.shift();null==(e=this.onmessage)||e.call(this,t.message,t.extra)}}async close(){var e;let t=this._otherTransport;this._otherTransport=void 0,await (null==t?void 0:t.close()),null==(e=this.onclose)||e.call(this)}async send(e,t){if(!this._otherTransport)throw Error("Not connected");this._otherTransport.onmessage?this._otherTransport.onmessage(e,{authInfo:null==t?void 0:t.authInfo}):this._otherTransport._messageQueue.push({message:e,extra:{authInfo:null==t?void 0:t.authInfo}})}}}}]);